<html><head><meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"><title>4.12. Options related to a particular phase</title><link rel="stylesheet" href="fptools.css" type="text/css"><meta name="generator" content="DocBook XSL Stylesheets V1.75.2"><link rel="home" href="index.html" title="The Parallel Haskell Compilation System User's Guide, Version 7.4.2"><link rel="up" href="using-ghc.html" title="Chapter 4. Using GHC"><link rel="prev" href="code-generators.html" title="4.11. GHC Backends"><link rel="next" href="using-shared-libs.html" title="4.13. Using shared libraries"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">4.12. Options related to a particular phase</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="code-generators.html">Prev</a> </td><th width="60%" align="center">Chapter 4. Using GHC</th><td width="20%" align="right"> <a accesskey="n" href="using-shared-libs.html">Next</a></td></tr></table><hr></div><div class="sect1" title="4.12. Options related to a particular phase"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="options-phases"></a>4.12. Options related to a particular phase</h2></div></div></div><div class="sect2" title="4.12.1. Replacing the program for one or more phases"><div class="titlepage"><div><div><h3 class="title"><a name="replacing-phases"></a>4.12.1. Replacing the program for one or more phases</h3></div></div></div><a class="indexterm" name="idp22997720"></a><p>You may specify that a different program be used for one
    of the phases of the compilation system, in place of whatever
    the <span class="command"><strong>ghc</strong></span> has wired into it.  For example, you
    might want to try a different assembler.  The following options
    allow you to change the external program used for a given
    compilation phase:</p><div class="variablelist"><dl><dt><span class="term">
          <code class="option">-pgmL</code> <em class="replaceable"><code>cmd</code></em>
        <a class="indexterm" name="idp23067640"></a>
        </span></dt><dd><p>Use <em class="replaceable"><code>cmd</code></em> as the literate
          pre-processor.</p></dd><dt><span class="term">
          <code class="option">-pgmP</code> <em class="replaceable"><code>cmd</code></em>
          <a class="indexterm" name="idp23069480"></a>
        </span></dt><dd><p>Use <em class="replaceable"><code>cmd</code></em> as the C
          pre-processor (with <code class="option">-cpp</code> only).</p></dd><dt><span class="term">
          <code class="option">-pgmc</code> <em class="replaceable"><code>cmd</code></em>
          <a class="indexterm" name="idp23071600"></a>
        </span></dt><dd><p>Use <em class="replaceable"><code>cmd</code></em> as the C
          compiler.</p></dd><dt><span class="term">
          <code class="option">-pgmlo</code> <em class="replaceable"><code>cmd</code></em>
          <a class="indexterm" name="idp23093536"></a>
        </span></dt><dd><p>Use <em class="replaceable"><code>cmd</code></em> as the LLVM
          optimiser.</p></dd><dt><span class="term">
          <code class="option">-pgmlc</code> <em class="replaceable"><code>cmd</code></em>
          <a class="indexterm" name="idp23095424"></a>
        </span></dt><dd><p>Use <em class="replaceable"><code>cmd</code></em> as the LLVM
          compiler.</p></dd><dt><span class="term">
          <code class="option">-pgms</code> <em class="replaceable"><code>cmd</code></em>
          <a class="indexterm" name="idp23097312"></a>
        </span></dt><dd><p>Use <em class="replaceable"><code>cmd</code></em> as the
          splitter.</p></dd><dt><span class="term">
          <code class="option">-pgma</code> <em class="replaceable"><code>cmd</code></em>
          <a class="indexterm" name="idp23099192"></a>
        </span></dt><dd><p>Use <em class="replaceable"><code>cmd</code></em> as the
          assembler.</p></dd><dt><span class="term">
          <code class="option">-pgml</code> <em class="replaceable"><code>cmd</code></em>
          <a class="indexterm" name="idp23101080"></a>
        </span></dt><dd><p>Use <em class="replaceable"><code>cmd</code></em> as the
          linker.</p></dd><dt><span class="term">
          <code class="option">-pgmdll</code> <em class="replaceable"><code>cmd</code></em>
          <a class="indexterm" name="idp23102960"></a>
        </span></dt><dd><p>Use <em class="replaceable"><code>cmd</code></em> as the DLL
          generator.</p></dd><dt><span class="term">
          <code class="option">-pgmF</code> <em class="replaceable"><code>cmd</code></em>
          <a class="indexterm" name="idp23104848"></a>
        </span></dt><dd><p>Use <em class="replaceable"><code>cmd</code></em> as the
          pre-processor (with <code class="option">-F</code> only).</p></dd><dt><span class="term">
          <code class="option">-pgmwindres</code> <em class="replaceable"><code>cmd</code></em>
          <a class="indexterm" name="idp23106952"></a>
        </span></dt><dd><p>Use <em class="replaceable"><code>cmd</code></em> as the
          program to use for embedding manifests on Windows.  Normally this
            is the program <code class="literal">windres</code>, which is supplied with a
            GHC installation. See <code class="option">-fno-embed-manifest</code> in <a class="xref" href="options-phases.html#options-linker" title="4.12.6. Options affecting linking">Section 4.12.6, &#8220;Options affecting linking&#8221;</a>.</p></dd></dl></div></div><div class="sect2" title="4.12.2. Forcing options to a particular phase"><div class="titlepage"><div><div><h3 class="title"><a name="forcing-options-through"></a>4.12.2. Forcing options to a particular phase</h3></div></div></div><a class="indexterm" name="idp23110016"></a><p>Options can be forced through to a particular compilation
    phase, using the following flags:</p><div class="variablelist"><dl><dt><span class="term">
          <code class="option">-optL</code> <em class="replaceable"><code>option</code></em>
          <a class="indexterm" name="idp23111504"></a>
        </span></dt><dd><p>Pass <em class="replaceable"><code>option</code></em> to the
          literate pre-processor</p></dd><dt><span class="term">
          <code class="option">-optP</code>  <em class="replaceable"><code>option</code></em>
          <a class="indexterm" name="idp23113432"></a>
        </span></dt><dd><p>Pass <em class="replaceable"><code>option</code></em> to CPP (makes
          sense only if <code class="option">-cpp</code> is also on).</p></dd><dt><span class="term">
          <code class="option">-optF</code> <em class="replaceable"><code>option</code></em>
          <a class="indexterm" name="idp23115568"></a>
        </span></dt><dd><p>Pass <em class="replaceable"><code>option</code></em> to the
          custom pre-processor (see <a class="xref" href="options-phases.html#pre-processor" title="4.12.4. Options affecting a Haskell pre-processor">Section 4.12.4, &#8220;Options affecting a Haskell pre-processor&#8221;</a>).</p></dd><dt><span class="term">
          <code class="option">-optc</code> <em class="replaceable"><code>option</code></em>
          <a class="indexterm" name="idp23117920"></a>
        </span></dt><dd><p>Pass <em class="replaceable"><code>option</code></em> to the C compiler.</p></dd><dt><span class="term">
          <code class="option">-optlo</code> <em class="replaceable"><code>option</code></em>
          <a class="indexterm" name="idp23119800"></a>
        </span></dt><dd><p>Pass <em class="replaceable"><code>option</code></em> to the LLVM optimiser.</p></dd><dt><span class="term">
          <code class="option">-optlc</code> <em class="replaceable"><code>option</code></em>
          <a class="indexterm" name="idp23121712"></a>
        </span></dt><dd><p>Pass <em class="replaceable"><code>option</code></em> to the LLVM compiler.</p></dd><dt><span class="term">
          <code class="option">-optm</code>  <em class="replaceable"><code>option</code></em>
          <a class="indexterm" name="idp23123624"></a>
        </span></dt><dd><p>Pass <em class="replaceable"><code>option</code></em> to the mangler.</p></dd><dt><span class="term">
          <code class="option">-opta</code>  <em class="replaceable"><code>option</code></em>
          <a class="indexterm" name="idp23125528"></a>
        </span></dt><dd><p>Pass <em class="replaceable"><code>option</code></em> to the assembler.</p></dd><dt><span class="term">
          <code class="option">-optl</code> <em class="replaceable"><code>option</code></em>
          <a class="indexterm" name="idp23127432"></a>
        </span></dt><dd><p>Pass <em class="replaceable"><code>option</code></em> to the linker.</p></dd><dt><span class="term">
          <code class="option">-optdll</code>  <em class="replaceable"><code>option</code></em>
          <a class="indexterm" name="idp23129336"></a>
        </span></dt><dd><p>Pass <em class="replaceable"><code>option</code></em> to the DLL generator.</p></dd><dt><span class="term">
          <code class="option">-optwindres</code>  <em class="replaceable"><code>option</code></em>
          <a class="indexterm" name="idp23131248"></a>
        </span></dt><dd><p>Pass <em class="replaceable"><code>option</code></em> to
            <code class="literal">windres</code> when embedding manifests on Windows.
            See <code class="option">-fno-embed-manifest</code> in <a class="xref" href="options-phases.html#options-linker" title="4.12.6. Options affecting linking">Section 4.12.6, &#8220;Options affecting linking&#8221;</a>.</p></dd></dl></div><p>So, for example, to force an <code class="option">-Ewurble</code>
    option to the assembler, you would tell the driver
    <code class="option">-opta-Ewurble</code> (the dash before the E is
    required).</p><p>GHC is itself a Haskell program, so if you need to pass
    options directly to GHC's runtime system you can enclose them in
    <code class="literal">+RTS ... -RTS</code> (see <a class="xref" href="runtime-control.html" title="4.17. Running a compiled program">Section 4.17, &#8220;Running a compiled program&#8221;</a>).</p></div><div class="sect2" title="4.12.3. Options affecting the C pre-processor"><div class="titlepage"><div><div><h3 class="title"><a name="c-pre-processor"></a>4.12.3. Options affecting the C pre-processor</h3></div></div></div><a class="indexterm" name="idp23136016"></a><a class="indexterm" name="idp23136408"></a><a class="indexterm" name="idp23136832"></a><div class="variablelist"><dl><dt><span class="term">
          <code class="option">-cpp</code>
          <a class="indexterm" name="idp23137848"></a>
        </span></dt><dd><p>The C pre-processor <span class="command"><strong>cpp</strong></span> is run
          over your Haskell code only if the <code class="option">-cpp</code>
          option <a class="indexterm" name="idp23139320"></a> is given.  Unless you are
          building a large system with significant doses of
          conditional compilation, you really shouldn't need
          it.</p></dd><dt><span class="term">
          <code class="option">-D</code><em class="replaceable"><code>symbol</code></em>[<span class="optional">=<em class="replaceable"><code>value</code></em></span>]
          <a class="indexterm" name="idp23140968"></a>
        </span></dt><dd><p>Define macro <em class="replaceable"><code>symbol</code></em> in the
          usual way.  NB: does <span class="emphasis"><em>not</em></span> affect
          <code class="option">-D</code> macros passed to the C compiler
          when compiling via C!  For those, use the
          <code class="option">-optc-Dfoo</code> hack&#8230; (see <a class="xref" href="options-phases.html#forcing-options-through" title="4.12.2. Forcing options to a particular phase">Section 4.12.2, &#8220;Forcing options to a particular phase&#8221;</a>).</p></dd><dt><span class="term">
          <code class="option">-U</code><em class="replaceable"><code>symbol</code></em>
          <a class="indexterm" name="idp23143992"></a>
        </span></dt><dd><p> Undefine macro <em class="replaceable"><code>symbol</code></em> in the
          usual way.</p></dd><dt><span class="term">
          <code class="option">-I</code><em class="replaceable"><code>dir</code></em>
          <a class="indexterm" name="idp23145808"></a>
        </span></dt><dd><p> Specify a directory in which to look for
          <code class="literal">#include</code> files, in the usual C
          way.</p></dd></dl></div><p>The GHC driver pre-defines several macros when processing
    Haskell source code (<code class="filename">.hs</code> or
    <code class="filename">.lhs</code> files).</p><p>The symbols defined by GHC are listed below.  To check which
    symbols are defined by your local GHC installation, the following
    trick is useful:</p><pre class="screen">$ ghc -E -optP-dM -cpp foo.hs
$ cat foo.hspp</pre><p>(you need a file <code class="filename">foo.hs</code>, but it isn't
    actually used).</p><div class="variablelist"><dl><dt><span class="term">
          <code class="constant">__GLASGOW_HASKELL__</code>
          <a class="indexterm" name="idp23150256"></a>
        </span></dt><dd><p>For version
          <code class="literal"><em class="replaceable"><code>x</code></em>.<em class="replaceable"><code>y</code></em>.<em class="replaceable"><code>z</code></em></code>
          of GHC, the value of
          <code class="constant">__GLASGOW_HASKELL__</code>
          is the integer <em class="replaceable"><code>xyy</code></em> (if
        <em class="replaceable"><code>y</code></em> is a single digit, then a leading zero
        is added, so for example in version 6.2 of GHC,
        <code class="literal">__GLASGOW_HASKELL__==602</code>).  More
          information in <a class="xref" href="version-numbering.html" title="1.4. GHC version numbering policy">Section 1.4, &#8220;GHC version numbering policy&#8221;</a>.</p><p>With any luck,
          <code class="constant">__GLASGOW_HASKELL__</code>
          will be undefined in all other implementations that
          support C-style pre-processing.</p><p>(For reference: the comparable symbols for other
          systems are:
          <code class="constant">__HUGS__</code>
          for Hugs,
          <code class="constant">__NHC__</code>
          for nhc98, and
          <code class="constant">__HBC__</code>
          for hbc.)</p><p>NB. This macro is set when pre-processing both
          Haskell source and C source, including the C source
          generated from a Haskell module
          (i.e. <code class="filename">.hs</code>, <code class="filename">.lhs</code>,
          <code class="filename">.c</code> and <code class="filename">.hc</code>
          files).</p></dd><dt><span class="term">
          <code class="constant">__PARALLEL_HASKELL__</code>
          <a class="indexterm" name="idp23157424"></a>
        </span></dt><dd><p>Only defined when <code class="option">-parallel</code> is in
          use!  This symbol is defined when pre-processing Haskell
          (input) and pre-processing C (GHC output).</p></dd><dt><span class="term">
          <code class="constant"><em class="replaceable"><code>os</code></em>_HOST_OS=1</code>
        </span></dt><dd><p>This define allows conditional compilation based on
          the Operating System, where<em class="replaceable"><code>os</code></em> is
          the name of the current Operating System
          (eg. <code class="literal">linux</code>, <code class="literal">mingw32</code>
          for Windows, <code class="literal">solaris</code>, etc.).</p></dd><dt><span class="term">
          <code class="constant"><em class="replaceable"><code>arch</code></em>_HOST_ARCH=1</code>
        </span></dt><dd><p>This define allows conditional compilation based on
          the host architecture, where<em class="replaceable"><code>arch</code></em>
          is the name of the current architecture
          (eg. <code class="literal">i386</code>, <code class="literal">x86_64</code>,
          <code class="literal">powerpc</code>, <code class="literal">sparc</code>,
          etc.).</p></dd></dl></div><div class="sect3" title="4.12.3.1. CPP and string gaps"><div class="titlepage"><div><div><h4 class="title"><a name="cpp-string-gaps"></a>4.12.3.1. CPP and string gaps</h4></div></div></div><p>A small word of warning: <code class="option">-cpp</code> is not
      friendly to &#8220;string gaps&#8221;.<a class="indexterm" name="idp22985200"></a><a class="indexterm" name="idp23165656"></a>.  In other words, strings
      such as the following:</p><pre class="programlisting">strmod = "\
\ p \
\ "</pre><p>don't work with <code class="option">-cpp</code>;
      <code class="filename">/usr/bin/cpp</code> elides the backslash-newline
      pairs.</p><p>However, it appears that if you add a space at the end
      of the line, then <span class="command"><strong>cpp</strong></span> (at least GNU
      <span class="command"><strong>cpp</strong></span> and possibly other
      <span class="command"><strong>cpp</strong></span>s) leaves the backslash-space pairs
      alone and the string gap works as expected.</p></div></div><div class="sect2" title="4.12.4. Options affecting a Haskell pre-processor"><div class="titlepage"><div><div><h3 class="title"><a name="pre-processor"></a>4.12.4. Options affecting a Haskell pre-processor</h3></div></div></div><a class="indexterm" name="idp23169560"></a><a class="indexterm" name="idp23169984"></a><div class="variablelist"><dl><dt><span class="term">
          <code class="option">-F</code>
          <a class="indexterm" name="idp23170984"></a>
        </span></dt><dd><p>A custom pre-processor is run over your Haskell
          source file only if the <code class="option">-F</code> option
          <a class="indexterm" name="idp23172040"></a> is
          given.</p><p>Running a custom pre-processor at compile-time is in
          some settings appropriate and useful. The
          <code class="option">-F</code> option lets you run a pre-processor as
          part of the overall GHC compilation pipeline, which has
          the advantage over running a Haskell pre-processor
          separately in that it works in interpreted mode and you
          can continue to take reap the benefits of GHC's
          recompilation checker.</p><p>The pre-processor is run just before the Haskell
          compiler proper processes the Haskell input, but after the
          literate markup has been stripped away and (possibly) the
          C pre-processor has washed the Haskell input.</p><p>Use
          <code class="option">-pgmF <em class="replaceable"><code>cmd</code></em></code>
          to select the program to use as the preprocessor.  When
          invoked, the <em class="replaceable"><code>cmd</code></em> pre-processor
          is given at least three arguments on its command-line: the
          first argument is the name of the original source file,
          the second is the name of the file holding the input, and
          the third is the name of the file where
          <em class="replaceable"><code>cmd</code></em> should write its output
          to.</p><p>Additional arguments to the pre-processor can be
          passed in using the <code class="option">-optF</code> option. These
          are fed to <em class="replaceable"><code>cmd</code></em> on the command
          line after the three standard input and output
          arguments.</p><p>
          An example of a pre-processor is to convert your source files to the
          input encoding that GHC expects, i.e. create a script
          <code class="literal">convert.sh</code> containing the lines:
          </p><pre class="screen">#!/bin/sh
( echo "{-# LINE 1 \"$2\" #-}" ; iconv -f l1 -t utf-8 $2 ) &gt; $3</pre><p>and pass <code class="literal">-F -pgmF convert.sh</code> to GHC.
          The <code class="literal">-f l1</code> option tells iconv to convert your
          Latin-1 file, supplied in argument <code class="literal">$2</code>, while
          the "-t utf-8" options tell iconv to return a UTF-8 encoded file.
          The result is redirected into argument <code class="literal">$3</code>.
          The <code class="literal">echo "{-# LINE 1 \"$2\" #-}"</code>
          just makes sure that your error positions are reported as
          in the original source file.</p></dd></dl></div></div><div class="sect2" title="4.12.5. Options affecting code generation"><div class="titlepage"><div><div><h3 class="title"><a name="options-codegen"></a>4.12.5. Options affecting code generation</h3></div></div></div><div class="variablelist"><dl><dt><span class="term">
          <code class="option">-fasm</code>
          <a class="indexterm" name="idp23180936"></a>
        </span></dt><dd><p>Use GHC's <a class="link" href="code-generators.html#native-code-gen" title="4.11.1. Native code Generator (-fasm)">native code generator
            </a>rather than compiling via LLVM.
          <code class="option">-fasm</code> is the default.</p></dd><dt><span class="term">
          <code class="option">-fllvm</code>
          <a class="indexterm" name="idp23183160"></a>
        </span></dt><dd><p>Compile via <a class="link" href="code-generators.html#llvm-code-gen" title="4.11.2. LLVM Code Generator (-fllvm)">LLVM</a>instead
          of using the native code generator. This will generally take slightly
          longer than the native code generator to compile. Produced code is
          generally the same speed or faster than the other two code
          generators. Compiling via LLVM requires LLVM to be on the
          path.</p></dd><dt><span class="term">
          <code class="option">-fno-code</code>
          <a class="indexterm" name="idp23185400"></a>
        </span></dt><dd><p>Omit code generation (and all later phases)
          altogether.  Might be of some use if you just want to see
          dumps of the intermediate compilation phases.</p></dd><dt><span class="term">
          <code class="option">-fobject-code</code>
          <a class="indexterm" name="idp23187008"></a>
        </span></dt><dd><p>Generate object code.  This is the default outside of
          GHCi, and can be used with GHCi to cause object code to be
          generated in preference to bytecode.</p></dd><dt><span class="term">
          <code class="option">-fbyte-code</code>
          <a class="indexterm" name="idp23188640"></a>
        </span></dt><dd><p>Generate byte-code instead of object-code.  This is
          the default in GHCi.  Byte-code can currently only be used
          in the interactive interpreter, not saved to disk.  This
          option is only useful for reversing the effect of
          <code class="option">-fobject-code</code>.</p></dd><dt><span class="term">
          <code class="option">-fPIC</code>
          <a class="indexterm" name="idp23190568"></a>
        </span></dt><dd><p>Generate position-independent code (code that can be put into
          shared libraries). This currently works on Linux x86 and x86-64. On
          Windows, position-independent code is never used so the flag is a
          no-op on that platform.</p></dd><dt><span class="term">
          <code class="option">-dynamic</code>
        </span></dt><dd><p>When generating code, assume that entities imported from a
          different package will reside in a different shared library or
          binary.</p><p>Note that using this option when linking causes GHC to link
          against shared libraries.</p></dd></dl></div></div><div class="sect2" title="4.12.6. Options affecting linking"><div class="titlepage"><div><div><h3 class="title"><a name="options-linker"></a>4.12.6. Options affecting linking</h3></div></div></div><a class="indexterm" name="idp23193976"></a><a class="indexterm" name="idp23194368"></a><p>GHC has to link your code with various libraries, possibly
    including: user-supplied, GHC-supplied, and system-supplied
    (<code class="option">-lm</code> math library, for example).</p><div class="variablelist"><dl><dt><span class="term">
          <code class="option">-l</code><em class="replaceable"><code>lib</code></em>
          <a class="indexterm" name="idp23196040"></a>
        </span></dt><dd><p>Link in the <em class="replaceable"><code>lib</code></em> library.
          On Unix systems, this will be in a file called
          <code class="filename">lib<em class="replaceable"><code>lib</code></em>.a</code>
          or
          <code class="filename">lib<em class="replaceable"><code>lib</code></em>.so</code>
          which resides somewhere on the library directories path.</p><p>Because of the sad state of most UNIX linkers, the
          order of such options does matter.  If library
          <em class="replaceable"><code>foo</code></em> requires library
          <em class="replaceable"><code>bar</code></em>, then in general
          <code class="option">-l</code><em class="replaceable"><code>foo</code></em> should
          come <span class="emphasis"><em>before</em></span>
          <code class="option">-l</code><em class="replaceable"><code>bar</code></em> on the
          command line.</p><p>There's one other gotcha to bear in mind when using
          external libraries: if the library contains a
          <code class="literal">main()</code> function, then this will be
          linked in preference to GHC's own
          <code class="literal">main()</code> function
          (eg. <code class="literal">libf2c</code> and <code class="literal">libl</code>
          have their own <code class="literal">main()</code>s).  This is
          because GHC's <code class="literal">main()</code> comes from the
          <code class="literal">HSrts</code> library, which is normally
          included <span class="emphasis"><em>after</em></span> all the other
          libraries on the linker's command line.  To force GHC's
          <code class="literal">main()</code> to be used in preference to any
          other <code class="literal">main()</code>s from external libraries,
          just add the option <code class="option">-lHSrts</code> before any
          other libraries on the command line.</p></dd><dt><span class="term">
          <code class="option">-c</code>
          <a class="indexterm" name="idp23205048"></a>
        </span></dt><dd><p>Omits the link step.  This option can be used with
            <code class="option">&#8211;&#8211;make</code> to avoid the automatic linking
            that takes place if the program contains a <code class="literal">Main</code>
            module.</p></dd><dt><span class="term">
          <code class="option">-package</code> <em class="replaceable"><code>name</code></em>
          <a class="indexterm" name="idp23207440"></a>
        </span></dt><dd><p>If you are using a Haskell &#8220;package&#8221;
          (see <a class="xref" href="packages.html" title="4.9.  Packages">Section 4.9, &#8220;
Packages
 &#8221;</a>), don't forget to add the
          relevant <code class="option">-package</code> option when linking the
          program too: it will cause the appropriate libraries to be
          linked in with the program.  Forgetting the
          <code class="option">-package</code> option will likely result in
          several pages of link errors.</p></dd><dt><span class="term">
          <code class="option">-framework</code> <em class="replaceable"><code>name</code></em>
          <a class="indexterm" name="idp23210232"></a>
        </span></dt><dd><p>On Darwin/MacOS X only, link in the framework <em class="replaceable"><code>name</code></em>.
          This option corresponds to the <code class="option">-framework</code> option for Apple's Linker.
          Please note that frameworks and packages are two different things - frameworks don't
          contain any haskell code. Rather, they are Apple's way of packaging shared libraries.
          To link to Apple's &#8220;Carbon&#8221; API, for example, you'd use
          <code class="option">-framework Carbon</code>.
          </p></dd><dt><span class="term">
          <code class="option">-L</code><em class="replaceable"><code>dir</code></em>
          <a class="indexterm" name="idp23212888"></a>
        </span></dt><dd><p>Where to find user-supplied libraries&#8230;
          Prepend the directory <em class="replaceable"><code>dir</code></em> to
          the library directories path.</p></dd><dt><span class="term">
          <code class="option">-framework-path</code><em class="replaceable"><code>dir</code></em>
          <a class="indexterm" name="idp23214760"></a>
        </span></dt><dd><p>On Darwin/MacOS X only, prepend the directory <em class="replaceable"><code>dir</code></em> to
          the framework directories path. This option corresponds to the <code class="option">-F</code>
          option for Apple's Linker (<code class="option">-F</code> already means something else for GHC).</p></dd><dt><span class="term">
          <code class="option">-split-objs</code>
          <a class="indexterm" name="idp23217016"></a>
        </span></dt><dd><p>Tell the linker to split the single object file that
          would normally be generated into multiple object files,
          one per top-level Haskell function or type in the module.
          This only makes sense for libraries, where it means that
          executables linked against the library are smaller as they only
          link against the object files that they need. However, assembling
          all the sections separately is expensive, so this is slower than
          compiling normally.
          We use this feature for building GHC's libraries
          (warning: don't use it unless you know what you're
          doing!).</p></dd><dt><span class="term">
          <code class="option">-static</code>
          <a class="indexterm" name="idp23219104"></a>
        </span></dt><dd><p>Tell the linker to avoid shared Haskell libraries,
          if possible.  This is the default.</p></dd><dt><span class="term">
          <code class="option">-dynamic</code>
          <a class="indexterm" name="idp23220640"></a>
        </span></dt><dd><p>This flag tells GHC to link against shared Haskell libraries.
          This flag only affects the selection of dependent libraries, not
          the form of the current target (see -shared).
          See <a class="xref" href="using-shared-libs.html" title="4.13. Using shared libraries">Section 4.13, &#8220;Using shared libraries&#8221;</a> on how to
          create them.</p><p>Note that this option also has an effect on
          code generation (see above).</p></dd><dt><span class="term">
          <code class="option">-shared</code>
          <a class="indexterm" name="idp23223040"></a>
        </span></dt><dd><p>Instead of creating an executable, GHC produces a
          shared object with this linker flag. Depending on the
          operating system target, this might be an ELF DSO, a Windows
          DLL, or a Mac OS dylib. GHC hides the operating system
          details beneath this uniform flag.</p><p>The flags <code class="option">-dynamic</code>/<code class="option">-static</code> control whether the
          resulting shared object links statically or dynamically to
          Haskell package libraries given as <code class="option">-package</code> option. Non-Haskell
          libraries are linked as gcc would regularly link it on your
          system, e.g. on most ELF system the linker uses the dynamic
          libraries when found.</p><p>Object files linked into shared objects must be
          compiled with <code class="option">-fPIC</code>, see <a class="xref" href="options-phases.html#options-codegen" title="4.12.5. Options affecting code generation">Section 4.12.5, &#8220;Options affecting code generation&#8221;</a></p><p>When creating shared objects for Haskell packages, the
          shared object must be named properly, so that GHC recognizes
          the shared object when linked against this package. See
          shared object name mangling.</p></dd><dt><span class="term">
          <code class="option">-dynload</code>
          <a class="indexterm" name="idp23227168"></a>
        </span></dt><dd><p>
            This flag selects one of a number of modes for finding shared
            libraries at runtime. See <a class="xref" href="using-shared-libs.html#finding-shared-libs" title="4.13.4. Finding shared libraries at runtime">Section 4.13.4, &#8220;Finding shared libraries at runtime&#8221;</a> for
            a description of each mode.
          </p></dd><dt><span class="term">
          <code class="option">-main-is <em class="replaceable"><code>thing</code></em></code>
          <a class="indexterm" name="idp23229336"></a>
          <a class="indexterm" name="idp23229808"></a>
        </span></dt><dd><p> The normal rule in Haskell is that your program must supply a <code class="literal">main</code>
            function in module <code class="literal">Main</code>.  When testing, it is often convenient
            to change which function is the "main" one, and the <code class="option">-main-is</code> flag
            allows you to do so.  The  <em class="replaceable"><code>thing</code></em> can be one of:
            </p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>A lower-case identifier <code class="literal">foo</code>.  GHC assumes that the main function is <code class="literal">Main.foo</code>.</p></li><li class="listitem"><p>A module name <code class="literal">A</code>.  GHC assumes that the main function is <code class="literal">A.main</code>.</p></li><li class="listitem"><p>A qualified name <code class="literal">A.foo</code>.  GHC assumes that the main function is <code class="literal">A.foo</code>.</p></li></ul></div><p>
            Strictly speaking, <code class="option">-main-is</code> is not a link-phase flag at all; it has no effect on the link step.
            The flag must be specified when compiling the module containing the specified main function (e.g. module <code class="literal">A</code>
            in the latter two items above).  It has no effect for other modules,
            and hence can safely be given to <code class="literal">ghc --make</code>.
            However, if all the modules are otherwise up to date, you may need to force
            recompilation both of the module where the new "main" is, and of the
            module where the "main" function used to be;
            <code class="literal">ghc</code> is not clever
            enough to figure out that they both need recompiling.  You can
            force recompilation by removing the object file, or by using the
            <code class="option">-fforce-recomp</code> flag.
            </p></dd><dt><span class="term">
          <code class="option">-no-hs-main</code>
          <a class="indexterm" name="idp23238160"></a>
          <a class="indexterm" name="idp23238632"></a>
        </span></dt><dd><p>In the event you want to include ghc-compiled code
          as part of another (non-Haskell) program, the RTS will not
          be supplying its definition of <code class="function">main()</code>
          at link-time, you will have to. To signal that to the
          compiler when linking, use
          <code class="option">-no-hs-main</code>. See also <a class="xref" href="ffi-ghc.html#using-own-main" title="8.2.1.1. Using your own main()">Section 8.2.1.1, &#8220;Using your own <code class="literal">main()</code>&#8221;</a>.</p><p>Notice that since the command-line passed to the
          linker is rather involved, you probably want to use
          <span class="command"><strong>ghc</strong></span> to do the final link of your
          `mixed-language' application. This is not a requirement
          though, just try linking once with <code class="option">-v</code> on
          to see what options the driver passes through to the
          linker.</p><p>The <code class="option">-no-hs-main</code> flag can also be
          used to persuade the compiler to do the link step in
          <code class="option">--make</code> mode when there is no Haskell
          <code class="literal">Main</code> module present (normally the
          compiler will not attempt linking when there is no
          <code class="literal">Main</code>).</p><p>The flags <code class="option">-rtsopts</code>
            and <code class="option">-with-rtsopts</code> have no effect when
            used with <code class="option">-no-hs-main</code>, because they are
            implemented by changing the definition
            of <code class="literal">main</code> that GHC generates.  See
            <a class="xref" href="ffi-ghc.html#using-own-main" title="8.2.1.1. Using your own main()">Section 8.2.1.1, &#8220;Using your own <code class="literal">main()</code>&#8221;</a> for how to get the
            effect of <code class="option">-rtsopts</code>
            and <code class="option">-with-rtsopts</code> when using your
            own <code class="literal">main</code>.
          </p></dd><dt><span class="term">
          <code class="option">-debug</code>
          <a class="indexterm" name="idp23246536"></a>
        </span></dt><dd><p>Link the program with a debugging version of the
          runtime system.  The debugging runtime turns on numerous
          assertions and sanity checks, and provides extra options
          for producing debugging output at runtime (run the program
          with <code class="literal">+RTS -?</code> to see a list).</p></dd><dt><span class="term">
          <code class="option">-threaded</code>
          <a class="indexterm" name="idp23248624"></a>
        </span></dt><dd><p>Link the program with the "threaded" version of the
          runtime system.  The threaded runtime system is so-called
          because it manages multiple OS threads, as opposed to the
          default runtime system which is purely
          single-threaded.</p><p>Note that you do <span class="emphasis"><em>not</em></span> need
          <code class="option">-threaded</code> in order to use concurrency; the
          single-threaded runtime supports concurrency between Haskell
          threads just fine.</p><p>The threaded runtime system provides the following
          benefits:</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>It enables the <code class="option">-N</code><a class="indexterm" name="idp23251344"></a> RTS option to be
                used, which allows threads to run in
                parallel<a class="indexterm" name="idp23252264"></a>
                on a
                multiprocessor<a class="indexterm" name="idp23252736"></a><a class="indexterm" name="idp23253088"></a>
                or
                multicore<a class="indexterm" name="idp23253560"></a>
                machine.  See <a class="xref" href="using-smp.html" title="4.15. Using SMP parallelism">Section 4.15, &#8220;Using SMP parallelism&#8221;</a>.</p></li><li class="listitem"><p>If a thread makes a foreign call (and the call is
                not marked <code class="literal">unsafe</code>), then other
                Haskell threads in the program will continue to run
                while the foreign call is in progress.
                Additionally, <code class="literal">foreign export</code>ed
                Haskell functions may be called from multiple OS
                threads simultaneously.  See
                <a class="xref" href="ffi-ghc.html#ffi-threads" title="8.2.4. Multi-threading and the FFI">Section 8.2.4, &#8220;Multi-threading and the FFI&#8221;</a>.</p></li></ul></div></dd><dt><span class="term">
          <code class="option">-eventlog</code>
          <a class="indexterm" name="idp23257032"></a>
        </span></dt><dd><p>
            Link the program with the "eventlog" version of the
            runtime system.  A program linked in this way can generate
            a runtime trace of events (such as thread start/stop) to a
            binary file
            <code class="literal"><em class="replaceable"><code>program</code></em>.eventlog</code>,
            which can then be interpreted later by various tools.  See
            <a class="xref" href="runtime-control.html#rts-eventlog" title="4.17.6. Tracing">Section 4.17.6, &#8220;Tracing&#8221;</a> for more information.
          </p><p>
            <code class="option">-eventlog</code> can be used
            with <code class="option">-threaded</code>.  It is implied
            by <code class="option">-debug</code>.
          </p></dd><dt><span class="term">
          <code class="option">-rtsopts</code>
          <a class="indexterm" name="idp23260672"></a>
        </span></dt><dd><p>
            This option affects the processing of RTS control options given either
            on the command line or via the <code class="envar">GHCRTS</code> environment variable.
            There are three possibilities:
          </p><div class="variablelist"><dl><dt><span class="term"><code class="option">-rtsopts=none</code></span></dt><dd><p>
                  Disable all processing of RTS options.
                  If <code class="option">+RTS</code> appears anywhere on the command
                  line, then the program will abort with an error message.
                  If the <code class="envar">GHCRTS</code> environment variable is
                  set, then the program will emit a warning message,
                  <code class="envar">GHCRTS</code> will be ignored, and the program
                  will run as normal.
                </p></dd><dt><span class="term"><code class="option">-rtsopts=some</code></span></dt><dd><p>[this is the default setting] Enable
                  only the "safe" RTS options: (Currently
                  only <code class="option">-?</code>
                  and <code class="option">--info</code>.)  Any other RTS options
                  on the command line or in the <code class="envar">GHCRTS</code>
                  environment variable causes the program with to abort
                  with an error message.
                </p></dd><dt><span class="term"><code class="option">-rtsopts=all</code>, or
 just <code class="option">-rtsopts</code></span></dt><dd><p>
                  Enable <span class="emphasis"><em>all</em></span> RTS option
                  processing, both on the command line and through
                  the <code class="envar">GHCRTS</code> environment variable.
                </p></dd></dl></div><p>
            In GHC 6.12.3 and earlier, the default was to process all
            RTS options. However, since RTS options can be used to
            write logging data to arbitrary files under the security
            context of the running program, there is a potential
            security problem.  For this reason, GHC 7.0.1 and later
            default to <code class="option">-rtsops=some</code>.
          </p><p>
            Note that <code class="option">-rtsopts</code> has no effect when
            used with <code class="option">-no-hs-main</code>; see
            <a class="xref" href="ffi-ghc.html#using-own-main" title="8.2.1.1. Using your own main()">Section 8.2.1.1, &#8220;Using your own <code class="literal">main()</code>&#8221;</a> for details.
          </p></dd><dt><span class="term">
          <code class="option">-with-rtsopts</code>
          <a class="indexterm" name="idp23270264"></a>
        </span></dt><dd><p>
            This option allows you to set the default RTS options at link-time. For example,
            <code class="option">-with-rtsopts="-H128m"</code> sets the default heap size to 128MB.
            This will always be the default heap size for this program, unless the user overrides it.
            (Depending on the setting of the <code class="option">-rtsopts</code> option, the user might
            not have the ability to change RTS options at run-time, in which case
            <code class="option">-with-rtsopts</code> would be the <span class="emphasis"><em>only</em></span> way to set
            them.)
          </p><p>
            Note that <code class="option">-with-rtsopts</code> has no effect when
            used with <code class="option">-no-hs-main</code>; see
            <a class="xref" href="ffi-ghc.html#using-own-main" title="8.2.1.1. Using your own main()">Section 8.2.1.1, &#8220;Using your own <code class="literal">main()</code>&#8221;</a> for details.
          </p></dd><dt><span class="term">
          <code class="option">-fno-gen-manifest</code>
          <a class="indexterm" name="idp23274080"></a>
        </span></dt><dd><p>On Windows, GHC normally generates a
            <em class="firstterm">manifest</em><a class="indexterm" name="idp23275144"></a> file when linking a binary.  The
            manifest is placed in the file
            <code class="literal"><em class="replaceable"><code>prog</code></em>.exe.manifest</code>
            where <em class="replaceable"><code>prog.exe</code></em> is the name of the
            executable.  The manifest file currently serves just one purpose:
            it disables the "installer detection"<a class="indexterm" name="idp23276656"></a>in Windows Vista that
            attempts to elevate privileges for executables with certain names
            (e.g. names containing "install", "setup" or "patch").  Without the
            manifest file to turn off installer detection, attempting to run an
            executable that Windows deems to be an installer will return a
            permission error code to the invoker.  Depending on the invoker,
            the result might be a dialog box asking the user for elevated
            permissions, or it might simply be a permission denied
            error.</p><p>Installer detection can be also turned off globally for the
            system using the security control panel, but GHC by default
            generates binaries that don't depend on the user having disabled
            installer detection.</p><p>The <code class="option">-fno-gen-manifest</code> disables generation of
            the manifest file.  One reason to do this would be if you had
            a manifest file of your own, for example.</p><p>In the future, GHC might use the manifest file for more things,
            such as supplying the location of dependent DLLs.</p><p><code class="option">-fno-gen-manifest</code> also implies
            <code class="option">-fno-embed-manifest</code>, see below.</p></dd><dt><span class="term">
          <code class="option">-fno-embed-manifest</code>
          <a class="indexterm" name="idp23280304"></a>
        </span></dt><dd><p>The manifest file that GHC generates when linking a binary on
            Windows is also embedded in the executable itself, by default.
            This means that the binary can be distributed without having to
            supply the manifest file too.  The embedding is done by running
            <code class="literal">windres</code><a class="indexterm" name="idp23281760"></a>; to see exactly what GHC does to embed the manifest,
            use the <code class="option">-v</code> flag.  A GHC installation comes with
            its own copy of <code class="literal">windres</code> for this reason.</p><p>See also <code class="option">-pgmwindres</code> (<a class="xref" href="options-phases.html#replacing-phases" title="4.12.1. Replacing the program for one or more phases">Section 4.12.1, &#8220;Replacing the program for one or more phases&#8221;</a>) and
            <code class="option">-optwindres</code> (<a class="xref" href="options-phases.html#forcing-options-through" title="4.12.2. Forcing options to a particular phase">Section 4.12.2, &#8220;Forcing options to a particular phase&#8221;</a>).</p></dd><dt><span class="term">
          <code class="option">-fno-shared-implib</code>
          <a class="indexterm" name="idp23285208"></a>
        </span></dt><dd><p>DLLs on Windows are typically linked to by linking to a corresponding
            <code class="literal">.lib</code> or <code class="literal">.dll.a</code> - the so-called import library.
            GHC will typically generate such a file for every DLL you create by compiling in
            <code class="literal">-shared</code> mode. However, sometimes you don't want to pay the
            disk-space cost of creating this import library, which can be substantial - it
            might require as much space as the code itself, as Haskell DLLs tend to export
            lots of symbols.</p><p>As long as you are happy to only be able to link to the DLL using
            <code class="literal">GetProcAddress</code> and friends, you can supply the
            <code class="option">-fno-shared-implib</code> flag to disable the creation of the import
            library entirely.</p></dd><dt><span class="term">
          <code class="option">-dylib-install-name <em class="replaceable"><code>path</code></em></code>
          <a class="indexterm" name="idp23289392"></a>
        </span></dt><dd><p>On Darwin/MacOS X, dynamic libraries are stamped at build time with an
              "install name", which is the ultimate install path of the library file.
              Any libraries or executables that subsequently link against it will pick
              up that path as their runtime search location for it. By default, ghc sets
              the install name to the location where the library is built. This option
              allows you to override it with the specified file path. (It passes
              <code class="literal">-install_name</code> to Apple's linker.) Ignored on other
              platforms.</p></dd></dl></div></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="code-generators.html">Prev</a> </td><td width="20%" align="center"><a accesskey="u" href="using-ghc.html">Up</a></td><td width="40%" align="right"> <a accesskey="n" href="using-shared-libs.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">4.11. GHC Backends </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> 4.13. Using shared libraries</td></tr></table></div></body></html>
