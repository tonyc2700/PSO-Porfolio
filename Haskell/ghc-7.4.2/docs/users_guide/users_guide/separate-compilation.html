<html><head><meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"><title>4.7. Filenames and separate compilation</title><link rel="stylesheet" href="fptools.css" type="text/css"><meta name="generator" content="DocBook XSL Stylesheets V1.75.2"><link rel="home" href="index.html" title="The Parallel Haskell Compilation System User's Guide, Version 7.4.2"><link rel="up" href="using-ghc.html" title="Chapter 4. Using GHC"><link rel="prev" href="options-help.html" title="4.6. Help and verbosity options"><link rel="next" href="options-sanity.html" title="4.8. Warnings and sanity-checking"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">4.7. Filenames and separate compilation</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="options-help.html">Prev</a> </td><th width="60%" align="center">Chapter 4. Using GHC</th><td width="20%" align="right"> <a accesskey="n" href="options-sanity.html">Next</a></td></tr></table><hr></div><div class="sect1" title="4.7. Filenames and separate compilation"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="separate-compilation"></a>4.7. Filenames and separate compilation</h2></div></div></div><a class="indexterm" name="idp21738096"></a><a class="indexterm" name="idp21738432"></a><a class="indexterm" name="idp21738856"></a><p>This section describes what files GHC expects to find, what
    files it creates, where these files are stored, and what options
    affect this behaviour.</p><p>Note that this section is written with
    <em class="firstterm">hierarchical modules</em> in mind (see <a class="xref" href="syntax-extns.html#hierarchical-modules" title="7.3.3. Hierarchical Modules">Section 7.3.3, &#8220;Hierarchical Modules&#8221;</a>); hierarchical modules are an
    extension to Haskell 98 which extends the lexical syntax of
    module names to include a dot &#8216;.&#8217;.  Non-hierarchical
    modules are thus a special case in which none of the module names
    contain dots.</p><p>Pathname conventions vary from system to system.  In
    particular, the directory separator is
    &#8216;<code class="literal">/</code>&#8217; on Unix systems and
    &#8216;<code class="literal">\</code>&#8217; on Windows systems.  In the
    sections that follow, we shall consistently use
    &#8216;<code class="literal">/</code>&#8217; as the directory separator;
    substitute this for the appropriate character for your
    system.</p><div class="sect2" title="4.7.1. Haskell source files"><div class="titlepage"><div><div><h3 class="title"><a name="source-files"></a>4.7.1. Haskell source files</h3></div></div></div><a class="indexterm" name="idp21777032"></a><p>Each Haskell source module should be placed in a file on
      its own.</p><p>Usually, the file should be named after the module name,
      replacing dots in the module name by directory separators.  For
      example, on a Unix system, the module <code class="literal">A.B.C</code>
      should be placed in the file <code class="literal">A/B/C.hs</code>,
      relative to some base directory.  If the module is not going to
      be imported by another module (<code class="literal">Main</code>, for
      example), then you are free to use any filename for it.</p><a class="indexterm" name="idp21799384"></a><p> GHC assumes that source files are
      ASCII<a class="indexterm" name="idp21799976"></a> or
      UTF-8<a class="indexterm" name="idp21800384"></a> only, other
      encodings<a class="indexterm" name="idp21800832"></a> are
      not recognised.  However, invalid UTF-8 sequences will be
      ignored in comments, so it is possible to use other encodings
      such as
      Latin-1<a class="indexterm" name="idp21801416"></a>, as
      long as the non-comment source code is ASCII only.</p></div><div class="sect2" title="4.7.2. Output files"><div class="titlepage"><div><div><h3 class="title"><a name="output-files"></a>4.7.2. Output files</h3></div></div></div><a class="indexterm" name="idp21802568"></a><a class="indexterm" name="idp21802984"></a><a class="indexterm" name="idp21803656"></a><a class="indexterm" name="idp21804072"></a><p>When asked to compile a source file, GHC normally
      generates two files: an <em class="firstterm">object file</em>, and
      an <em class="firstterm">interface file</em>. </p><p>The object file, which normally ends in a
      <code class="literal">.o</code> suffix, contains the compiled code for the
      module.</p><p>The interface file,
      which normally ends in a <code class="literal">.hi</code> suffix, contains
      the information that GHC needs in order to compile further
      modules that depend on this module.  It contains things like the
      types of exported functions, definitions of data types, and so
      on.  It is stored in a binary format, so don't try to read one;
      use the <code class="option">--show-iface</code> option instead (see <a class="xref" href="separate-compilation.html#hi-options" title="4.7.7. Other options related to interface files">Section 4.7.7, &#8220;Other options related to interface files&#8221;</a>).</p><p>You should think of the object file and the interface file as a
      pair, since the interface file is in a sense a compiler-readable
      description of the contents of the object file.  If the
      interface file and object file get out of sync for any reason,
      then the compiler may end up making assumptions about the object
      file that aren't true; trouble will almost certainly follow.
      For this reason, we recommend keeping object files and interface
      files in the same place (GHC does this by default, but it is
      possible to override the defaults as we'll explain
      shortly).</p><p>Every module has a <span class="emphasis"><em>module name</em></span>
      defined in its source code (<code class="literal">module A.B.C where
      ...</code>).</p><p>The name of the object file generated by GHC is derived
      according to the following rules, where
      <em class="replaceable"><code>osuf</code></em> is the object-file suffix (this
      can be changed with the <code class="option">-osuf</code> option).</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>If there is no <code class="option">-odir</code> option (the
	  default), then the object filename is derived from the
	  source filename (ignoring the module name) by replacing the
	  suffix with <em class="replaceable"><code>osuf</code></em>.</p></li><li class="listitem"><p>If
	  <code class="option">-odir</code> <em class="replaceable"><code>dir</code></em>
	  has been specified, then the object filename is
	  <em class="replaceable"><code>dir</code></em>/<em class="replaceable"><code>mod</code></em>.<em class="replaceable"><code>osuf</code></em>,
	  where <em class="replaceable"><code>mod</code></em> is the module name with
	  dots replaced by slashes.  GHC will silently create the necessary directory
          structure underneath <em class="replaceable"><code>dir</code></em>, if it does not
          already exist.</p></li></ul></div><p>The name of the interface file is derived using the same
      rules, except that the suffix is
      <em class="replaceable"><code>hisuf</code></em> (<code class="literal">.hi</code> by
      default) instead of <em class="replaceable"><code>osuf</code></em>, and the
      relevant options are <code class="option">-hidir</code> and
      <code class="option">-hisuf</code> instead of <code class="option">-odir</code> and
      <code class="option">-osuf</code> respectively.</p><p>For example, if GHC compiles the module
      <code class="literal">A.B.C</code> in the file
      <code class="filename">src/A/B/C.hs</code>, with no
      <code class="literal">-odir</code> or <code class="literal">-hidir</code> flags, the
      interface file will be put in <code class="literal">src/A/B/C.hi</code>
      and the object file in <code class="literal">src/A/B/C.o</code>.</p><p>For any module that is imported, GHC requires that the
      name of the module in the import statement exactly matches the
      name of the module in the interface file (or source file) found
      using the strategy specified in <a class="xref" href="separate-compilation.html#search-path" title="4.7.3. The search path">Section 4.7.3, &#8220;The search path&#8221;</a>.
      This means that for most modules, the source file name should
      match the module name.</p><p>However, note that it is reasonable to have a module
      <code class="literal">Main</code> in a file named
      <code class="filename">foo.hs</code>, but this only works because GHC
      never needs to search for the interface for module
      <code class="literal">Main</code> (because it is never imported).  It is
      therefore possible to have several <code class="literal">Main</code>
      modules in separate source files in the same directory, and GHC
      will not get confused.</p><p>In batch compilation mode, the name of the object file can
      also be overridden using the <code class="option">-o</code> option, and the
      name of the interface file can be specified directly using the
      <code class="option">-ohi</code> option.</p></div><div class="sect2" title="4.7.3. The search path"><div class="titlepage"><div><div><h3 class="title"><a name="search-path"></a>4.7.3. The search path</h3></div></div></div><a class="indexterm" name="idp21822128"></a><a class="indexterm" name="idp21822584"></a><a class="indexterm" name="idp21823016"></a><p>In your program, you import a module
      <code class="literal">Foo</code> by saying <code class="literal">import Foo</code>.
      In <code class="option">--make</code> mode or GHCi, GHC will look for a
      source file for <code class="literal">Foo</code> and arrange to compile it
      first.  Without <code class="option">--make</code>, GHC will look for the
      interface file for <code class="literal">Foo</code>, which should have
      been created by an earlier compilation of
      <code class="literal">Foo</code>.  GHC uses the same strategy in each of
      these cases for finding the appropriate file.</p><p>This strategy is as follows: GHC keeps a list of
      directories called the <em class="firstterm">search path</em>.  For
      each of these directories, it tries appending
      <em class="replaceable"><code>basename</code></em><code class="literal">.</code><em class="replaceable"><code>extension</code></em>
      to the directory, and checks whether the file exists.  The value
      of <em class="replaceable"><code>basename</code></em> is the module name with
      dots replaced by the directory separator ('/' or '\', depending
      on the system), and <em class="replaceable"><code>extension</code></em> is a
      source extension (<code class="literal">hs</code>, <code class="literal">lhs</code>)
      if we are in <code class="option">--make</code> mode or GHCi, or
      <em class="replaceable"><code>hisuf</code></em> otherwise.</p><p>For example, suppose the search path contains directories
      <code class="literal">d1</code>, <code class="literal">d2</code>, and
      <code class="literal">d3</code>, and we are in <code class="literal">--make</code>
      mode looking for the source file for a module
      <code class="literal">A.B.C</code>.  GHC will look in
      <code class="literal">d1/A/B/C.hs</code>, <code class="literal">d1/A/B/C.lhs</code>,
      <code class="literal">d2/A/B/C.hs</code>, and so on.</p><p>The search path by default contains a single directory:
      <span class="quote">&#8220;<span class="quote">.</span>&#8221;</span> (i.e. the current directory).  The following
      options can be used to add to or change the contents of the
      search path:</p><div class="variablelist"><dl><dt><span class="term"><code class="option">-i<em class="replaceable"><code>dirs</code></em></code></span></dt><dd><p><a class="indexterm" name="idp21833840"></a>This flag appends a colon-separated
            list of <code class="filename">dirs</code> to the search path.</p></dd><dt><span class="term"><code class="option">-i</code></span></dt><dd><p>resets the search path back to nothing.</p></dd></dl></div><p>This isn't the whole story: GHC also looks for modules in
      pre-compiled libraries, known as packages.  See the section on
      packages (<a class="xref" href="packages.html" title="4.9.  Packages">Section 4.9, &#8220;
Packages
 &#8221;</a>) for details.</p></div><div class="sect2" title="4.7.4. Redirecting the compilation output(s)"><div class="titlepage"><div><div><h3 class="title"><a name="options-output"></a>4.7.4. Redirecting the compilation output(s)</h3></div></div></div><a class="indexterm" name="idp21837520"></a><a class="indexterm" name="idp21837928"></a><div class="variablelist"><dl><dt><span class="term">
            <code class="option">-o</code> <em class="replaceable"><code>file</code></em>
            <a class="indexterm" name="idp21839144"></a>
          </span></dt><dd><p>GHC's compiled output normally goes into a
            <code class="filename">.hc</code>, <code class="filename">.o</code>, etc.,
            file, depending on the last-run compilation phase.  The
            option <code class="option">-o <em class="replaceable"><code>file</code></em></code>
            re-directs the output of that last-run phase to
            <em class="replaceable"><code>file</code></em>.</p><p>Note: this &#8220;feature&#8221; can be
            counterintuitive: <span class="command"><strong>ghc -C -o foo.o
            foo.hs</strong></span> will put the intermediate C code in the
            file <code class="filename">foo.o</code>, name
            notwithstanding!</p><p>This option is most often used when creating an
	    executable file, to set the filename of the executable.
	    For example:
</p><pre class="screen">   ghc -o prog --make Main</pre><p>

            will compile the program starting with module
            <code class="literal">Main</code>  and put the executable in the
            file <code class="literal">prog</code>.</p><p>Note: on Windows, if the result is an executable
            file, the extension "<code class="filename">.exe</code>" is added
            if the specified filename does not already have an
            extension.  Thus
</p><pre class="programlisting">
   ghc -o foo Main.hs
</pre><p>
          will compile and link the module
          <code class="filename">Main.hs</code>, and put the resulting
          executable in <code class="filename">foo.exe</code> (not
          <code class="filename">foo</code>).</p><p>If you use <span class="command"><strong>ghc --make</strong></span> and you don't
          use the <code class="option">-o</code>, the name GHC will choose
          for the executable will be based on the name of the file
          containing the module <code class="literal">Main</code>.
          Note that with GHC the <code class="literal">Main</code> module doesn't
          have to be put in file <code class="filename">Main.hs</code>.
          Thus both
</p><pre class="programlisting">
   ghc --make Prog
</pre><p>
          and
</p><pre class="programlisting">
   ghc --make Prog.hs
</pre><p>
          will produce <code class="filename">Prog</code> (or
          <code class="filename">Prog.exe</code> if you are on Windows).</p></dd><dt><span class="term">
            <code class="option">-odir</code> <em class="replaceable"><code>dir</code></em>
            <a class="indexterm" name="idp21850696"></a>
          </span></dt><dd><p>Redirects object files to directory
	    <em class="replaceable"><code>dir</code></em>.  For example:</p><pre class="screen">
$ ghc -c parse/Foo.hs parse/Bar.hs gurgle/Bumble.hs -odir `uname -m`
</pre><p>The object files, <code class="filename">Foo.o</code>,
            <code class="filename">Bar.o</code>, and
            <code class="filename">Bumble.o</code> would be put into a
            subdirectory named after the architecture of the executing
            machine (<code class="filename">x86</code>,
            <code class="filename">mips</code>, etc).</p><p>Note that the <code class="option">-odir</code> option does
            <span class="emphasis"><em>not</em></span> affect where the interface files
            are put; use the <code class="option">-hidir</code> option for that.
            In the above example, they would still be put in
            <code class="filename">parse/Foo.hi</code>,
            <code class="filename">parse/Bar.hi</code>, and
            <code class="filename">gurgle/Bumble.hi</code>.</p></dd><dt><span class="term">
            <code class="option">-ohi</code>  <em class="replaceable"><code>file</code></em>
            <a class="indexterm" name="idp21857312"></a>
          </span></dt><dd><p>The interface output may be directed to another file
            <code class="filename">bar2/Wurble.iface</code> with the option
            <code class="option">-ohi bar2/Wurble.iface</code> (not
            recommended).</p><p>WARNING: if you redirect the interface file
	    somewhere that GHC can't find it, then the recompilation
	    checker may get confused (at the least, you won't get any
	    recompilation avoidance).  We recommend using a
	    combination of <code class="option">-hidir</code> and
	    <code class="option">-hisuf</code> options instead, if
	    possible.</p><p>To avoid generating an interface at all, you could
            use this option to redirect the interface into the bit
            bucket: <code class="literal">-ohi /dev/null</code>, for
            example.</p></dd><dt><span class="term">
            <code class="option">-hidir</code>  <em class="replaceable"><code>dir</code></em>
            <a class="indexterm" name="idp21861312"></a>
          </span></dt><dd><p>Redirects all generated interface files into
	    <em class="replaceable"><code>dir</code></em>, instead of the
	    default.</p></dd><dt><span class="term">
            <code class="option">-stubdir</code>  <em class="replaceable"><code>dir</code></em>
            <a class="indexterm" name="idp21863240"></a>
          </span></dt><dd><p>Redirects all generated FFI stub files into
	    <em class="replaceable"><code>dir</code></em>.  Stub files are generated when the
	    Haskell source contains a <code class="literal">foreign export</code> or
	    <code class="literal">foreign import "&amp;wrapper"</code> declaration (see <a class="xref" href="ffi-ghc.html#foreign-export-ghc" title='8.2.1. Using foreign export and foreign import ccall "wrapper" with GHC'>Section 8.2.1, &#8220;Using <code class="literal">foreign export</code> and <code class="literal">foreign import ccall "wrapper"</code> with GHC&#8221;</a>).  The <code class="option">-stubdir</code>
	      option behaves in exactly the same way as <code class="option">-odir</code>
	      and <code class="option">-hidir</code> with respect to hierarchical
	    modules.</p></dd><dt><span class="term">
            <code class="option">-dumpdir</code>  <em class="replaceable"><code>dir</code></em>
            <a class="indexterm" name="idp21867128"></a>
          </span></dt><dd><p>Redirects all dump files into
	    <em class="replaceable"><code>dir</code></em>.  Dump files are generated when
	    <code class="literal">-ddump-to-file</code> is used with other
	    <code class="literal">-ddump-*</code> flags.</p></dd><dt><span class="term">
            <code class="option">-outputdir</code> <em class="replaceable"><code>dir</code></em>
            <a class="indexterm" name="idp21869792"></a>
          </span></dt><dd><p>The <code class="option">-outputdir</code> option is shorthand for
              the combination
              of <code class="option">-odir</code>, <code class="option">-hidir</code>,
              <code class="option">-stubdir</code> and <code class="option">-dumpdir</code>.
            </p></dd><dt><span class="term">
            <code class="option">-osuf</code> <em class="replaceable"><code>suffix</code></em>
            <a class="indexterm" name="idp21872648"></a>
          , </span><span class="term">
            <code class="option">-hisuf</code> <em class="replaceable"><code>suffix</code></em>
            <a class="indexterm" name="idp21873728"></a>
          , </span><span class="term">
            <code class="option">-hcsuf</code> <em class="replaceable"><code>suffix</code></em>
            <a class="indexterm" name="idp21874808"></a>
          </span></dt><dd><p>The <code class="option">-osuf</code>
            <em class="replaceable"><code>suffix</code></em> will change the
            <code class="literal">.o</code> file suffix for object files to
            whatever you specify.  We use this when compiling
            libraries, so that objects for the profiling versions of
            the libraries don't clobber the normal ones.</p><p>Similarly, the <code class="option">-hisuf</code>
            <em class="replaceable"><code>suffix</code></em> will change the
            <code class="literal">.hi</code> file suffix for non-system
            interface files (see <a class="xref" href="separate-compilation.html#hi-options" title="4.7.7. Other options related to interface files">Section 4.7.7, &#8220;Other options related to interface files&#8221;</a>).</p><p>Finally, the option <code class="option">-hcsuf</code>
            <em class="replaceable"><code>suffix</code></em> will change the
            <code class="literal">.hc</code> file suffix for compiler-generated
            intermediate C files.</p><p>The <code class="option">-hisuf</code>/<code class="option">-osuf</code>
            game is particularly useful if you want to compile a
            program both with and without profiling, in the same
            directory.  You can say:
	    </p><pre class="screen">
	      ghc ...</pre><p>
	    to get the ordinary version, and
	    </p><pre class="screen">
	      ghc ... -osuf prof.o -hisuf prof.hi -prof -auto-all</pre><p>
	    to get the profiled version.</p></dd></dl></div></div><div class="sect2" title="4.7.5. Keeping Intermediate Files"><div class="titlepage"><div><div><h3 class="title"><a name="keeping-intermediates"></a>4.7.5. Keeping Intermediate Files</h3></div></div></div><a class="indexterm" name="idp21881688"></a><a class="indexterm" name="idp21882176"></a><a class="indexterm" name="idp21882920"></a><a class="indexterm" name="idp21883664"></a><p>The following options are useful for keeping certain
      intermediate files around, when normally GHC would throw these
      away after compilation:</p><div class="variablelist"><dl><dt><span class="term">
            <code class="option">-keep-hc-file</code>,
            <code class="option">-keep-hc-files</code>
            <a class="indexterm" name="idp21885600"></a>
            <a class="indexterm" name="idp21886080"></a>
          </span></dt><dd><p>Keep intermediate <code class="literal">.hc</code> files when
	    doing <code class="literal">.hs</code>-to-<code class="literal">.o</code>
      compilations via <a class="link" href="code-generators.html#c-code-gen" title="4.11.3. C Code Generator (-fvia-C)">C</a> (NOTE:
      <code class="literal">.hc</code> files are only generated by
      <a class="link" href="code-generators.html#unreg" title="4.11.4. Unregisterised compilation">unregisterised</a> compilers).</p></dd><dt><span class="term">
            <code class="option">-keep-llvm-file</code>,
            <code class="option">-keep-llvm-files</code>
            <a class="indexterm" name="idp21890208"></a>
            <a class="indexterm" name="idp21890672"></a>
          </span></dt><dd><p>Keep intermediate <code class="literal">.ll</code> files when
	    doing <code class="literal">.hs</code>-to-<code class="literal">.o</code>
      compilations via <a class="link" href="code-generators.html#llvm-code-gen" title="4.11.2. LLVM Code Generator (-fllvm)">LLVM</a>
      (NOTE: <code class="literal">.ll</code> files aren't generated when using the
      native code generator, you may need to use <code class="option">-fllvm</code> to
      force them to be produced).</p></dd><dt><span class="term">
            <code class="option">-keep-s-file</code>,
            <code class="option">-keep-s-files</code>
            <a class="indexterm" name="idp21894648"></a>
            <a class="indexterm" name="idp21895128"></a>
          </span></dt><dd><p>Keep intermediate <code class="literal">.s</code> files.</p></dd><dt><span class="term">
            <code class="option">-keep-tmp-files</code>
            <a class="indexterm" name="idp21896960"></a>
            <a class="indexterm" name="idp21897440"></a>
          </span></dt><dd><p>Instructs the GHC driver not to delete any of its
	    temporary files, which it normally keeps in
	    <code class="literal">/tmp</code> (or possibly elsewhere; see <a class="xref" href="separate-compilation.html#temp-files" title="4.7.6. Redirecting temporary files">Section 4.7.6, &#8220;Redirecting temporary files&#8221;</a>).  Running GHC with
	    <code class="option">-v</code> will show you what temporary files
	    were generated along the way.</p></dd></dl></div></div><div class="sect2" title="4.7.6. Redirecting temporary files"><div class="titlepage"><div><div><h3 class="title"><a name="temp-files"></a>4.7.6. Redirecting temporary files</h3></div></div></div><a class="indexterm" name="idp21900368"></a><div class="variablelist"><dl><dt><span class="term">
            <code class="option">-tmpdir</code>
            <a class="indexterm" name="idp21901696"></a>
          </span></dt><dd><p>If you have trouble because of running out of space
            in <code class="filename">/tmp</code> (or wherever your
            installation thinks temporary files should go), you may
            use the <code class="option">-tmpdir
            &lt;dir&gt;</code><a class="indexterm" name="idp21903192"></a> option to specify
            an alternate directory.  For example, <code class="option">-tmpdir
            .</code> says to put temporary files in the current
            working directory.</p><p>Alternatively, use your <code class="constant">TMPDIR</code>
            environment variable.<a class="indexterm" name="idp21904488"></a> Set it to the
            name of the directory where temporary files should be put.
            GCC and other programs will honour the
            <code class="constant">TMPDIR</code> variable as well.</p><p>Even better idea: Set the
            <code class="constant">DEFAULT_TMPDIR</code> make variable when
            building GHC, and never worry about
            <code class="constant">TMPDIR</code> again. (see the build
            documentation).</p></dd></dl></div></div><div class="sect2" title="4.7.7. Other options related to interface files"><div class="titlepage"><div><div><h3 class="title"><a name="hi-options"></a>4.7.7. Other options related to interface files</h3></div></div></div><a class="indexterm" name="idp21907016"></a><div class="variablelist"><dl><dt><span class="term">
            <code class="option">-ddump-hi</code>
            <a class="indexterm" name="idp21908016"></a>
          </span></dt><dd><p>Dumps the new interface to standard output.</p></dd><dt><span class="term">
            <code class="option">-ddump-hi-diffs</code>
            <a class="indexterm" name="idp21909520"></a>
          </span></dt><dd><p>The compiler does not overwrite an existing
            <code class="filename">.hi</code> interface file if the new one is
            the same as the old one; this is friendly to
            <span class="command"><strong>make</strong></span>.  When an interface does change,
            it is often enlightening to be informed.  The
            <code class="option">-ddump-hi-diffs</code> option will make GHC
            report the differences between the old and
            new <code class="filename">.hi</code> files.</p></dd><dt><span class="term">
            <code class="option">-ddump-minimal-imports</code>
            <a class="indexterm" name="idp21912616"></a>
          </span></dt><dd><p>Dump to the file "M.imports" (where M is the module
            being compiled) a "minimal" set of import declarations.
            You can safely replace all the import declarations in
            "M.hs" with those found in "M.imports".  Why would you
            want to do that?  Because the "minimal" imports (a) import
            everything explicitly, by name, and (b) import nothing
            that is not required.  It can be quite painful to maintain
            this property by hand, so this flag is intended to reduce
            the labour.</p></dd><dt><span class="term">
            <code class="option">--show-iface</code> <em class="replaceable"><code>file</code></em>
            <a class="indexterm" name="idp21914856"></a>
          </span></dt><dd><p>where <em class="replaceable"><code>file</code></em> is the name of
	    an interface file, dumps the contents of that interface in
	    a human-readable (ish) format. See <a class="xref" href="modes.html" title="4.5. Modes of operation">Section 4.5, &#8220;Modes of operation&#8221;</a>.</p></dd></dl></div></div><div class="sect2" title="4.7.8. The recompilation checker"><div class="titlepage"><div><div><h3 class="title"><a name="recomp"></a>4.7.8. The recompilation checker</h3></div></div></div><a class="indexterm" name="idp21917200"></a><div class="variablelist"><dl><dt><span class="term">
            <code class="option">-fforce-recomp</code>
            <a class="indexterm" name="idp21918208"></a>
            <a class="indexterm" name="idp21918688"></a>
          </span></dt><dd><p>Turn off recompilation checking (which is on by
            default).  Recompilation checking normally stops
            compilation early, leaving an existing
            <code class="filename">.o</code> file in place, if it can be
            determined that the module does not need to be
            recompiled.</p></dd></dl></div><p>In the olden days, GHC compared the newly-generated
      <code class="filename">.hi</code> file with the previous version; if they
      were identical, it left the old one alone and didn't change its
      modification date.  In consequence, importers of a module with
      an unchanged output <code class="filename">.hi</code> file were not
      recompiled.</p><p>This doesn't work any more.  Suppose module
      <code class="literal">C</code> imports module <code class="literal">B</code>, and
      <code class="literal">B</code> imports module <code class="literal">A</code>.  So
      changes to module <code class="literal">A</code> might require module
      <code class="literal">C</code> to be recompiled, and hence when
      <code class="filename">A.hi</code> changes we should check whether
      <code class="literal">C</code> should be recompiled.  However, the
      dependencies of <code class="literal">C</code> will only list
      <code class="literal">B.hi</code>, not <code class="literal">A.hi</code>, and some
      changes to <code class="literal">A</code> (changing the definition of a
      function that appears in an inlining of a function exported by
      <code class="literal">B</code>, say) may conceivably not change
      <code class="filename">B.hi</code> one jot.  So now&#8230;</p><p>GHC calculates a fingerprint (in fact an MD5 hash) of each
      interface file, and of each declaration within the interface
      file.  It also keeps in every interface file a list of the
      fingerprints of everything it used when it last compiled the
      file.  If the source file's modification date is earlier than
      the <code class="filename">.o</code> file's date (i.e. the source hasn't
      changed since the file was last compiled), and the recompilation
      checking is on, GHC will be clever.  It compares the fingerprints
      on the things it needs this time with the fingerprints
      on the things it needed last time (gleaned from the
      interface file of the module being compiled); if they are all
      the same it stops compiling early in the process saying
      &#8220;Compilation IS NOT required&#8221;.  What a beautiful
      sight!</p><p>You can read
      about <a class="ulink" href="http://hackage.haskell.org/trac/ghc/wiki/Commentary/Compiler/RecompilationAvoidance" target="_top">how
          all this works</a> in the GHC commentary.</p></div><div class="sect2" title="4.7.9. How to compile mutually recursive modules"><div class="titlepage"><div><div><h3 class="title"><a name="mutual-recursion"></a>4.7.9. How to compile mutually recursive modules</h3></div></div></div><a class="indexterm" name="idp21929800"></a><a class="indexterm" name="idp21930496"></a><p>GHC supports the compilation of mutually recursive modules.
      This section explains how.</p><p>Every cycle in the module import graph must be broken by a <code class="filename">hs-boot</code> file.
      Suppose that modules <code class="filename">A.hs</code> and <code class="filename">B.hs</code> are Haskell source files,
      thus:
</p><pre class="programlisting">
module A where
    import B( TB(..) )

    newtype TA = MkTA Int

    f :: TB -&gt; TA
    f (MkTB x) = MkTA x

module B where
    import {-# SOURCE #-} A( TA(..) )

    data TB = MkTB !Int

    g :: TA -&gt; TB
    g (MkTA x) = MkTB x
</pre><p>
<a class="indexterm" name="idp21933328"></a> <a class="indexterm" name="idp21934024"></a>
Here <code class="filename">A</code> imports <code class="filename">B</code>, but <code class="filename">B</code> imports
<code class="filename">A</code> with a <code class="literal">{-# SOURCE #-}</code> pragma, which breaks the
circular dependency.  Every loop in the module import graph must be broken by a <code class="literal">{-# SOURCE #-}</code> import;
or, equivalently, the module import graph must be acyclic if <code class="literal">{-# SOURCE #-}</code> imports are ignored.
</p><p>For every module <code class="filename">A.hs</code> that is <code class="literal">{-# SOURCE #-}</code>-imported
in this way there must exist a source file <code class="literal">A.hs-boot</code>.  This file contains an abbreviated
version of <code class="filename">A.hs</code>, thus:
</p><pre class="programlisting">
module A where
    newtype TA = MkTA Int
</pre><p>
</p><p>To compile these three files, issue the following commands:
</p><pre class="programlisting">
  ghc -c A.hs-boot    -- Produces A.hi-boot, A.o-boot
  ghc -c B.hs         -- Consumes A.hi-boot, produces B.hi, B.o
  ghc -c A.hs	      -- Consumes B.hi, produces A.hi, A.o
  ghc -o foo A.o B.o  -- Linking the program
</pre><p>
</p><p>There are several points to note here:
</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>The file <code class="filename">A.hs-boot</code> is a programmer-written source file.
  It must live in the same directory as its parent source file <code class="filename">A.hs</code>.
  Currently, if you use a literate source file <code class="filename">A.lhs</code> you must
  also use a literate boot file, <code class="filename">A.lhs-boot</code>; and vice versa.
  </p></li><li class="listitem"><p>
  A <code class="filename">hs-boot</code> file is compiled by GHC, just like a <code class="filename">hs</code> file:
</p><pre class="programlisting">
  ghc -c A.hs-boot
</pre><p>
When a hs-boot file <code class="filename">A.hs-boot</code>
   is compiled, it is checked for scope and type errors.
   When its parent module <code class="filename">A.hs</code> is compiled, the two are compared, and
   an error is reported if the two are inconsistent.
   </p></li><li class="listitem"><p> Just as compiling <code class="filename">A.hs</code> produces an
	    interface file <code class="filename">A.hi</code>, and an object file
	    <code class="filename">A.o</code>, so compiling
	    <code class="filename">A.hs-boot</code> produces an interface file
	    <code class="filename">A.hi-boot</code>, and an pseudo-object file
	    <code class="filename">A.o-boot</code>: </p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem"><p>The pseudo-object file <code class="filename">A.o-boot</code> is
		empty (don't link it!), but it is very useful when using a
		Makefile, to record when the <code class="filename">A.hi-boot</code> was
		last brought up to date (see <a class="xref" href="separate-compilation.html#using-make" title="4.7.10. Using make">Section 4.7.10, &#8220;Using <span class="command"><strong>make</strong></span>&#8221;</a>).</p></li><li class="listitem"><p>The <code class="filename">hi-boot</code> generated by compiling a
		<code class="filename">hs-boot</code> file is in the same
		machine-generated binary format as any other GHC-generated
		interface file (e.g. <code class="filename">B.hi</code>). You can
		display its contents with <span class="command"><strong>ghc
		  --show-iface</strong></span>. If you specify a directory for
		interface files, the <code class="option">-ohidir</code> flag, then that
		affects <code class="filename">hi-boot</code> files
		too.</p></li></ul></div></li><li class="listitem"><p> If hs-boot files are considered distinct from their parent source
   files, and if a <code class="literal">{-# SOURCE #-}</code> import is considered to refer to the
   hs-boot file, then the module import graph must have no cycles.  The command
   <span class="command"><strong>ghc -M</strong></span> will report an error if a cycle is found.
   </p></li><li class="listitem"><p> A module <code class="literal">M</code> that is
   <code class="literal">{-# SOURCE #-}</code>-imported in a program will usually also be
   ordinarily imported elsewhere.  If not, <span class="command"><strong>ghc --make</strong></span>
   automatically adds <code class="literal">M</code> to the set of modules it tries to
   compile and link, to ensure that <code class="literal">M</code>'s implementation is included in
   the final program.
   </p></li></ul></div><p>
</p><p>
A hs-boot file need only contain the bare
      minimum of information needed to get the bootstrapping process
      started.  For example, it doesn't need to contain declarations
      for <span class="emphasis"><em>everything</em></span> that module
      <code class="literal">A</code> exports, only the things required by the
      module(s) that import <code class="literal">A</code> recursively.</p><p>A hs-boot file is written in a subset of Haskell:
</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p> The module header (including the export list), and import statements, are exactly as in
Haskell, and so are the scoping rules.
   Hence, to mention a non-Prelude type or class, you must import it.</p></li><li class="listitem"><p> There must be no value declarations, but there can be type signatures for
values.  For example:
</p><pre class="programlisting">
  double :: Int -&gt; Int
</pre><p>
</p></li><li class="listitem"><p> Fixity declarations are exactly as in Haskell.</p></li><li class="listitem"><p> Type synonym declarations are exactly as in Haskell.</p></li><li class="listitem"><p> A data type declaration can either be given in full, exactly as in Haskell, or it
can be given abstractly, by omitting the '=' sign and everything that follows.  For example:
</p><pre class="programlisting">
  data T a b
</pre><p>
	    In a <span class="emphasis"><em>source</em></span> program
	  this would declare TA to have no constructors (a GHC extension: see <a class="xref" href="data-type-extensions.html#nullary-types" title="7.4.1. Data types with no constructors">Section 7.4.1, &#8220;Data types with no constructors&#8221;</a>),
	  but in an hi-boot file it means "I don't know or care what the constructors are".
	    This is the most common form of data type declaration, because it's easy to get right.
	  You <span class="emphasis"><em>can</em></span> also write out the constructors but, if you do so, you must write
	  it out precisely as in its real definition.</p><p>
	    If you do not write out the constructors, you may need to give a kind
	    annotation (<a class="xref" href="other-type-extensions.html#kinding" title="7.11.4. Explicitly-kinded quantification">Section 7.11.4, &#8220;Explicitly-kinded quantification&#8221;</a>), to tell
	    GHC the kind of the type variable, if it is not "*".  (In source files, this is worked out
	    from the way the type variable is used in the constructors.)  For example:
</p><pre class="programlisting">
  data R (x :: * -&gt; *) y
</pre><p>
You cannot use <code class="literal">deriving</code> on a data type declaration; write an
<code class="literal">instance</code> declaration instead.
</p></li><li class="listitem"><p> Class declarations is exactly as in Haskell, except that you may not put
default method declarations.  You can also omit all the superclasses and class
methods entirely; but you must either omit them all or put them all in.
</p></li><li class="listitem"><p> You can include instance declarations just as in Haskell; but omit the "where" part.
 </p></li></ul></div><p>
</p></div><div class="sect2" title="4.7.10. Using make"><div class="titlepage"><div><div><h3 class="title"><a name="using-make"></a>4.7.10. Using <span class="command"><strong>make</strong></span></h3></div></div></div><a class="indexterm" name="idp21965232"></a><p>It is reasonably straightforward to set up a
      <code class="filename">Makefile</code> to use with GHC, assuming you name
      your source files the same as your modules.  Thus:</p><pre class="programlisting">
HC      = ghc
HC_OPTS = -cpp $(EXTRA_HC_OPTS)

SRCS = Main.lhs Foo.lhs Bar.lhs
OBJS = Main.o   Foo.o   Bar.o

.SUFFIXES : .o .hs .hi .lhs .hc .s

cool_pgm : $(OBJS)
        rm -f $@
        $(HC) -o $@ $(HC_OPTS) $(OBJS)

# Standard suffix rules
.o.hi:
        @:

.lhs.o:
        $(HC) -c $&lt; $(HC_OPTS)

.hs.o:
        $(HC) -c $&lt; $(HC_OPTS)

.o-boot.hi-boot:
        @:

.lhs-boot.o-boot:
        $(HC) -c $&lt; $(HC_OPTS)

.hs-boot.o-boot:
        $(HC) -c $&lt; $(HC_OPTS)

# Inter-module dependencies
Foo.o Foo.hc Foo.s    : Baz.hi          # Foo imports Baz
Main.o Main.hc Main.s : Foo.hi Baz.hi   # Main imports Foo and Baz
</pre><p>(Sophisticated <span class="command"><strong>make</strong></span> variants may
      achieve some of the above more elegantly.  Notably,
      <span class="command"><strong>gmake</strong></span>'s pattern rules let you write the more
      comprehensible:</p><pre class="programlisting">
%.o : %.lhs
        $(HC) -c $&lt; $(HC_OPTS)
</pre><p>What we've shown should work with any
      <span class="command"><strong>make</strong></span>.)</p><p>Note the cheesy <code class="literal">.o.hi</code> rule: It records
      the dependency of the interface (<code class="filename">.hi</code>) file
      on the source.  The rule says a <code class="filename">.hi</code> file
      can be made from a <code class="filename">.o</code> file by
      doing&#8230;nothing.  Which is true.</p><p> Note that the suffix rules are all repeated twice, once
      for normal Haskell source files, and once for <code class="filename">hs-boot</code>
      files (see <a class="xref" href="separate-compilation.html#mutual-recursion" title="4.7.9. How to compile mutually recursive modules">Section 4.7.9, &#8220;How to compile mutually recursive modules&#8221;</a>).</p><p>Note also the inter-module dependencies at the end of the
      Makefile, which take the form

</p><pre class="programlisting">
Foo.o Foo.hc Foo.s    : Baz.hi          # Foo imports Baz
</pre><p>

      They tell <span class="command"><strong>make</strong></span> that if any of
      <code class="literal">Foo.o</code>, <code class="literal">Foo.hc</code> or
      <code class="literal">Foo.s</code> have an earlier modification date than
      <code class="literal">Baz.hi</code>, then the out-of-date file must be
      brought up to date.  To bring it up to date,
      <code class="literal">make</code> looks for a rule to do so; one of the
      preceding suffix rules does the job nicely.  These dependencies
      can be generated automatically by <span class="command"><strong>ghc</strong></span>; see
      <a class="xref" href="separate-compilation.html#makefile-dependencies" title="4.7.11. Dependency generation">Section 4.7.11, &#8220;Dependency generation&#8221;</a></p></div><div class="sect2" title="4.7.11. Dependency generation"><div class="titlepage"><div><div><h3 class="title"><a name="makefile-dependencies"></a>4.7.11. Dependency generation</h3></div></div></div><a class="indexterm" name="idp21977736"></a><a class="indexterm" name="idp21978160"></a><p>Putting inter-dependencies of the form <code class="literal">Foo.o :
        Bar.hi</code> into your <code class="filename">Makefile</code> by
        hand is rather error-prone.  Don't worry, GHC has support for
        automatically generating the required dependencies.  Add the
        following to your <code class="filename">Makefile</code>:</p><pre class="programlisting">
depend :
        ghc -M $(HC_OPTS) $(SRCS)
</pre><p>Now, before you start compiling, and any time you change
        the <code class="literal">imports</code> in your program, do
        <span class="command"><strong>make depend</strong></span> before you do <span class="command"><strong>make
        cool_pgm</strong></span>.  The command <span class="command"><strong>ghc -M</strong></span> will
        append the needed dependencies to your
        <code class="filename">Makefile</code>.</p><p>In general, <span class="command"><strong>ghc -M Foo</strong></span> does the following.
	For each module <code class="literal">M</code> in the set
	<code class="literal">Foo</code> plus all its imports (transitively),
	it adds to the Makefile:
	</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>A line recording the dependence of the object file on the source file.
</p><pre class="programlisting">
M.o : M.hs
</pre><p>
(or <code class="literal">M.lhs</code> if that is the filename you used).
       </p></li><li class="listitem"><p> For each import declaration <code class="literal">import X</code> in <code class="literal">M</code>,
       a line recording the dependence of <code class="literal">M</code> on <code class="literal">X</code>:
</p><pre class="programlisting">
M.o : X.hi
</pre></li><li class="listitem"><p> For each import declaration <code class="literal">import {-# SOURCE #-} X</code> in <code class="literal">M</code>,
       a line recording the dependence of <code class="literal">M</code> on <code class="literal">X</code>:
</p><pre class="programlisting">
M.o : X.hi-boot
</pre><p>
       (See <a class="xref" href="separate-compilation.html#mutual-recursion" title="4.7.9. How to compile mutually recursive modules">Section 4.7.9, &#8220;How to compile mutually recursive modules&#8221;</a> for details of
       <code class="literal">hi-boot</code> style interface files.)
      </p></li></ul></div><p>
	If <code class="literal">M</code> imports multiple modules, then there will
       be multiple lines with <code class="filename">M.o</code> as the
       target.</p><p>There is no need to list all of the source files as arguments to the <span class="command"><strong>ghc -M</strong></span> command;
       <span class="command"><strong>ghc</strong></span> traces the dependencies, just like <span class="command"><strong>ghc --make</strong></span>
       (a new feature in GHC 6.4).</p><p>Note that <code class="literal">ghc -M</code> needs to find a <span class="emphasis"><em>source
	file</em></span> for each module in the dependency graph, so that it can
      parse the import declarations and follow dependencies.  Any pre-compiled
      modules without source files must therefore belong to a
      package<sup>[<a name="idp21993408" href="#ftn.idp21993408" class="footnote">7</a>]</sup>.</p><p>By default, <span class="command"><strong>ghc -M</strong></span> generates all the
        dependencies, and then concatenates them onto the end of
        <code class="filename">makefile</code> (or
        <code class="filename">Makefile</code> if <code class="filename">makefile</code>
        doesn't exist) bracketed by the lines "<code class="literal"># DO NOT
        DELETE: Beginning of Haskell dependencies</code>" and
        "<code class="literal"># DO NOT DELETE: End of Haskell
        dependencies</code>".  If these lines already exist in the
        <code class="filename">makefile</code>, then the old dependencies are
        deleted first.</p><p>Don't forget to use the same <code class="option">-package</code>
	options on the <code class="literal">ghc -M</code> command line as you
	would when compiling; this enables the dependency generator to
	locate any imported modules that come from packages.  The
	package modules won't be included in the dependencies
	generated, though (but see the
	<code class="option">&#8211;&#8211;include-pkg-deps</code> option below).</p><p>The dependency generation phase of GHC can take some
        additional options, which you may find useful.

	The options which affect dependency generation are:</p><div class="variablelist"><dl><dt><span class="term"><code class="option">-ddump-mod-cycles</code></span></dt><dd><p>Display a list of the cycles in the module graph. This is
	  useful when trying to eliminate such cycles.</p></dd><dt><span class="term"><code class="option">-v2</code></span></dt><dd><p>Print a full list of the module dependencies to stdout.
	            (This is the standard verbosity flag, so the list will
	      also be displayed with <code class="option">-v3</code> and
	      <code class="option">-v4</code>;
	      <a class="xref" href="options-help.html" title="4.6. Help and verbosity options">Section 4.6, &#8220;Help and verbosity options&#8221;</a>.)</p></dd><dt><span class="term"><code class="option">-dep-makefile</code> <em class="replaceable"><code>file</code></em></span></dt><dd><p>Use <em class="replaceable"><code>file</code></em> as the makefile,
              rather than <code class="filename">makefile</code> or
              <code class="filename">Makefile</code>.  If
              <em class="replaceable"><code>file</code></em> doesn't exist,
              <span class="command"><strong>mkdependHS</strong></span> creates it.  We often use
              <code class="option">-dep-makefile .depend</code> to put the dependencies in
              <code class="filename">.depend</code> and then
              <span class="command"><strong>include</strong></span> the file
              <code class="filename">.depend</code> into
              <code class="filename">Makefile</code>.</p></dd><dt><span class="term"><code class="option">-dep-suffix &lt;suf&gt;</code></span></dt><dd><p>Make extra dependencies that declare that files
              with suffix
              <code class="filename">.&lt;suf&gt;_&lt;osuf&gt;</code>
              depend on interface files with suffix
              <code class="filename">.&lt;suf&gt;_hi</code>, or (for
              <code class="literal">{-# SOURCE #-}</code>
              imports) on <code class="filename">.hi-boot</code>.  Multiple
              <code class="option">-dep-suffix</code> flags are permitted.  For example,
              <code class="option">-dep-suffix a -dep-suffix b</code>
              will make dependencies
              for <code class="filename">.hs</code> on
              <code class="filename">.hi</code>,
              <code class="filename">.a_hs</code> on
              <code class="filename">.a_hi</code>, and
              <code class="filename">.b_hs</code> on
              <code class="filename">.b_hi</code>.  (Useful in
              conjunction with NoFib "ways".)</p></dd><dt><span class="term"><code class="option">&#8211;&#8211;exclude-module=&lt;file&gt;</code></span></dt><dd><p>Regard <code class="filename">&lt;file&gt;</code> as
              "stable"; i.e., exclude it from having dependencies on
              it.</p></dd><dt><span class="term"><code class="option">&#8211;&#8211;include-pkg-deps</code></span></dt><dd><p>Regard modules imported from packages as unstable,
              i.e., generate dependencies on any imported package modules
              (including <code class="literal">Prelude</code>, and all other
              standard Haskell libraries).  Dependencies are not traced
	      recursively into packages; dependencies are only generated for
	      home-package modules on external-package modules directly imported
	      by the home package module.
	      This option is normally
              only used by the various system libraries.</p></dd></dl></div></div><div class="sect2" title="4.7.12. Orphan modules and instance declarations"><div class="titlepage"><div><div><h3 class="title"><a name="orphan-modules"></a>4.7.12. Orphan modules and instance declarations</h3></div></div></div><p> Haskell specifies that when compiling module M, any instance
declaration in any module "below" M is visible.  (Module A is "below"
M if A is imported directly by M, or if A is below a module that M imports directly.)
In principle, GHC must therefore read the interface files of every module below M,
just in case they contain an instance declaration that matters to M.  This would
be a disaster in practice, so GHC tries to be clever. </p><p>In particular, if an instance declaration is in the same module as the definition
of any type or class mentioned in the <span class="emphasis"><em>head</em></span> of the instance declaration
(the part after the &#8220;<code class="literal">=&gt;</code>&#8221;; see <a class="xref" href="type-class-extensions.html#instance-rules" title="7.6.3.2. Relaxed rules for instance contexts">Section 7.6.3.2, &#8220;Relaxed rules for instance contexts&#8221;</a>), then
GHC has to visit that interface file anyway.  Example:</p><pre class="programlisting">
  module A where
    instance C a =&gt; D (T a) where ...
    data T a = ...
</pre><p> The instance declaration is only relevant if the type T is in use, and if
so, GHC will have visited A's interface file to find T's definition. </p><p> The only problem comes when a module contains an instance declaration
and GHC has no other reason for visiting the module.  Example:
</p><pre class="programlisting">
  module Orphan where
    instance C a =&gt; D (T a) where ...
    class C a where ...
</pre><p>
Here, neither D nor T is declared in module Orphan.
We call such modules &#8220;orphan modules&#8221;.
GHC identifies orphan modules, and visits the interface file of
every orphan module below the module being compiled.  This is usually
wasted work, but there is no avoiding it.  You should therefore do
your best to have as few orphan modules as possible.
</p><p>
Functional dependencies complicate matters.  Suppose we have:
</p><pre class="programlisting">
  module B where
    instance E T Int where ...
    data T = ...
</pre><p>
Is this an orphan module?  Apparently not, because <code class="literal">T</code>
is declared in the same module.  But suppose class <code class="literal">E</code> had a
functional dependency:
</p><pre class="programlisting">
  module Lib where
    class E x y | y -&gt; x where ...
</pre><p>
Then in some importing module M, the constraint <code class="literal">(E a Int)</code> should be "improved" by setting
<code class="literal">a = T</code>, <span class="emphasis"><em>even though there is no explicit mention
of <code class="literal">T</code> in M</em></span>.</p>

These considerations lead to the following definition of an orphan module:
<div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p> An <span class="emphasis"><em>orphan module</em></span>
  <a class="indexterm" name="idp22023008"></a>
  contains at least one <span class="emphasis"><em>orphan instance</em></span> or at
  least one <span class="emphasis"><em>orphan rule</em></span>.</p></li><li class="listitem"><p> An instance declaration in a module M is an <span class="emphasis"><em>orphan instance</em></span> if
  <a class="indexterm" name="idp22024512"></a>
</p><div class="itemizedlist"><ul class="itemizedlist" type="circle"><li class="listitem"><p>
  The class of the instance declaration is not declared in M, and
</p></li><li class="listitem"><p> <span class="emphasis"><em>Either</em></span> the class has no functional dependencies, and none of the type constructors
	in the instance head is declared in M; <span class="emphasis"><em>or</em></span> there
	is a functional dependency for which none of the type constructors mentioned
	in the <span class="emphasis"><em>non-determined</em></span> part of the instance head is defined in M.
	</p></li></ul></div><p>
  </p><p> Only the instance head
  counts.  In the example above, it is not good enough for C's declaration
  to be in module A; it must be the declaration of D or T.</p></li><li class="listitem"><p> A rewrite rule in a module M is an <span class="emphasis"><em>orphan rule</em></span>
  <a class="indexterm" name="idp22027608"></a>
  if none of the variables, type constructors,
  or classes that are free in the left hand side of the rule are declared in M.
  </p></li></ul></div><p>If you use the flag <code class="option">-fwarn-orphans</code>, GHC will warn you
if you are creating an orphan module.
Like any warning, you can switch the warning off with <code class="option">-fno-warn-orphans</code>,
and <code class="option">-Werror</code>
will make the compilation fail if the warning is issued.
</p><p>
You can identify an orphan module by looking in its interface
file, <code class="filename">M.hi</code>, using the
<a class="link" href="modes.html" title="4.5. Modes of operation"><code class="option">--show-iface</code> mode</a>.  If there is a <code class="literal">[orphan module]</code> on the
first line, GHC considers it an orphan module.
</p></div><div class="footnotes"><br><hr width="100" align="left"><div class="footnote"><p><sup>[<a name="ftn.idp21993408" href="#idp21993408" class="para">7</a>] </sup>This is a change in behaviour relative to 6.2 and
	earlier.</p></div></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="options-help.html">Prev</a> </td><td width="20%" align="center"><a accesskey="u" href="using-ghc.html">Up</a></td><td width="40%" align="right"> <a accesskey="n" href="options-sanity.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">4.6. Help and verbosity options </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> 4.8. Warnings and sanity-checking</td></tr></table></div></body></html>
